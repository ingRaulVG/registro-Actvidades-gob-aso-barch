<script>
    function crearTablaRegActividades(){

        let tabla = document.getElementById('tablaRegActividades');
        if(tabla) tabla.remove();

        google.script.run.withSuccessHandler(
            function(obj){

                
                tabla = document.createElement('table');
                tabla.id = 'tablaRegActividades';

                let tableHeader = document.createElement('thead');
                let tablaBody = document.createElement('tbody');
                let primerFila = document.createElement('tr');

                // Header de la tabla 
                for(let k =0; k < obj[0].length; k++){
                    let primeraCelda = document.createElement('td');
                    primeraCelda.textContent = obj[0][k];
                    primerFila.appendChild(primeraCelda);
                }
                tableHeader.appendChild(primerFila);
                tabla.appendChild(tableHeader);

                // El body de la tabla 
                for(let i = 1; i< obj.length; i++){
                    let fila = document.createElement('tr');
                    for(let j = 0; j<obj[i].length; j++){
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    }
                    
                    tablaBody.appendChild(fila);
                }

                // Array.from(obj).forEach((filaActual, i) =>{
                //     let fila = document.createElement('tr');
                //     filaActual.forEach(celdaActual =>{
                //         let celda = document.createElement('td');
                //         celda.textContent = celdaActual;
                //         fila.appendChild(celda);
                //     });
                //     if(i == 0){
                //         tableHeader.appendChild(fila);
                //         tabla.appendChild(tableHeader);
                //     }else{
                //         tablaBody.appendChild(fila);
                //     }
                    
                // });

                //Agregamos clases ala cabecera
                tableHeader.classList.add('table-dark');

                //Agregramos el cuerpo a la tabla
                tabla.appendChild(tablaBody);

                //agregamos clases a la tabla 
                tabla.classList.add('table', 'table-striped', 'border', 'border-3');

                //agremos tabla a la pagina
                document.getElementById('divRegActvidades').appendChild(tabla);

            }
         ).obtenerRegActividades();
    }
</script>